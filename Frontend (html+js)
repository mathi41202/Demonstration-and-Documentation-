<!-- file: index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>File Upload Manager - Phase 5</title>
<style>
  body { font-family: Arial; margin: 40px; }
  .progress { height: 20px; background: #eee; border-radius: 5px; margin-top: 10px; }
  .progress-bar { height: 100%; background: #4caf50; width: 0%; transition: width 0.3s; }
  .file-list { margin-top: 20px; }
</style>
</head>
<body>
<h2>ðŸ“‚ File Upload Manager â€“ Phase 5</h2>
<input type="file" id="fileInput" multiple>
<button onclick="uploadFiles()">Upload</button>

<div class="progress"><div id="progressBar" class="progress-bar"></div></div>
<div id="status"></div>

<h3>Uploaded Files</h3>
<ul id="fileList" class="file-list"></ul>

<script>
async function uploadFiles() {
  const files = document.getElementById("fileInput").files;
  const formData = new FormData();
  for (const file of files) formData.append("files", file);

  const xhr = new XMLHttpRequest();
  xhr.open("POST", "http://localhost:5000/upload");

  xhr.upload.onprogress = e => {
    if (e.lengthComputable) {
      const percent = (e.loaded / e.total) * 100;
      document.getElementById("progressBar").style.width = percent + "%";
    }
  };

  xhr.onload = () => {
    document.getElementById("status").textContent = "Upload complete!";
    loadFiles();
  };

  xhr.send(formData);
}

async function loadFiles() {
  const res = await fetch("http://localhost:5000/files");
  const files = await res.json();
  const list = document.getElementById("fileList");
  list.innerHTML = "";
  files.forEach(f => {
    const li = document.createElement("li");
    li.innerHTML = `${f} 
      <a href="http://localhost:5000/uploads/${f}" target="_blank">View</a> |
      <button onclick="deleteFile('${f}')">Delete</button>`;
    list.appendChild(li);
  });
}

async function deleteFile(name) {
  await fetch(`http://localhost:5000/files/${name}`, { method: "DELETE" });
  loadFiles();
}

loadFiles();
</script>
</body>
</html>
